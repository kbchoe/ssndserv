
<!-- saved from url=(0030)http://ssndlab.com/notice.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Smart Structures &amp; Design Lab</title>
		<link href="./admin2.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<div id="container">
			<div class="cont_nav">&nbsp;</div>
			<h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;공지사항</h3>
			<div class="sch_top"></div>
		</div>

		<div class="cont">
			<table width="95%" class="tb_01" cellpadding="0" cellspacing="0">
				<colgroup>
					<col width="80">
					<col width="*">
					<col width="100">
					<col width="100">
				</colgroup>
				<thead>
					<tr>
						<th>NO</th>
						<th>TITLE</th>
						<th>WRITER</th>
						<th>DATE</th>
					</tr>
				</thead>
				
				<tbody id=articles>
				  <tr>
					<td class="txtC">1</td>
					<td class="txtL"><a href="#">제목</a></td>
					<td class="txtC">관리자</td>
					<td class="txtC">2020-08-21</td>
				  </tr>					
				  <tr>
					<td class="txtC">2</td>
					<td class="txtL"><a href="#">제목</a></td>
					<td class="txtC">관리자</td>
					<td class="txtC">2020-08-21</td>
				  </tr>					
				  <tr>
					<td class="txtC">3</td>
					<td class="txtL"><a href="#">제목</a></td>
					<td class="txtC">관리자</td>
					<td class="txtC">2020-08-21</td>
				  </tr>				
				</tbody>
				
				<tbody>
				</tbody>
			</table>
		</div>

<div class="paginate_regular" id="pagination">
<a href="JavaScript:onPage(1)">1</a>
<a href="JavaScript:onPage(2)">2</a>
<a href="JavaScript:onPage(3)">3</a>
<a href="JavaScript:onPage(4)">4</a>
<a href="JavaScript:onPage(5)">5</a>
<a href="JavaScript:onPage(2)">다음</a>
</div>

<form name="mainForm" method="post">
	<input type="hidden" name="NoticeSeq">
	<input type="hidden" name="mNumber">
</form>



<script>

function parseTextBlocks_(text) {
  const blocks = text.split('///////..( / 16개)');
  return blocks.map(block => {
    //const lines = block.trim().split('\n');
    const lines = block.replace(/\r/g, '').trim().split('\n');
    const title = lines[0] || '';
    const date = lines[1] || '';
    const file = lines[2] || '';
    const body = lines.slice(3).join('\n');
    return { title, date, file, body };
  });
}

function parseTextBlocks(text) {
  const blocks = text.split('///////////////'); // 구분자만으로 split
  return blocks
    .map(block => {
      const lines = block.replace(/\r/g, '').trim().split('\n');
      if (lines.length < 1 || !lines[0].trim()) return null; // 빈 블록 무시
      const title = lines[0] || '';
      const date = lines[1] || '';
      const file = lines[2] || '';
      const body = lines.slice(3).join('\n');
      return { title, date, file, body };
    })
    .filter(b => b); // null 제거
}

const article_box = document.querySelector('#articles'); // 삽입할 tbody 선택

var pagenum = 1;
var blocks;

fetch('newone.txt')
  .then(response => {
    if (!response.ok) throw new Error('파일 로드 실패');
    return response.text();
  })
  .then(text => {
    //console.log(text); // txt 내용
    blocks = parseTextBlocks(text);
    blocks.sort((a, b) => new Date(b.date) - new Date(a.date));

    const totalPages = Math.ceil(blocks.length / 10); // 예: 132 -> 14페이지

    const paginationContainer = document.querySelector('#pagination'); // 페이지 링크 넣을 영역
	let html_page = '';

	for (let i = 1; i <= totalPages; i++) {
	  html_page += `<a href="JavaScript:onPage(${i})" >${i}</a> `;
	}
	paginationContainer.innerHTML = html_page;

	blocks.forEach((block, idx) => {
	  block.no = blocks.length - idx; // 120개면 idx=0 → 120, idx=1 → 119 ...
	});
    //blocks.forEach(block => {
	onPage(1);
  })
  .catch(err => console.error(err))

function onView (block_idx) {
	block = blocks[block_idx];
	block.title;
	block.date;
	block.file;
	block.body;


	let article_box = document.querySelector('#articles'); // 삽입할 tbody 선택
	
	let img_html = '';
	if (block.file) { // block.file이 있으면 이미지
	  img_html = `<br><br><img src="/board_files/${block.file}" alt="${block.file}" width="600" height=auto>`
	}

    let html = '';
    html += `
			<div class="cont">	    	
	    	<table width="100%" class="tb_01_reg" cellpadding="0" cellspacing="0">
			
			<colgroup>
				<col width="20%">
				<col width="*">
			</colgroup>
			
			<tbody>
				<tr>
					<th>제목</th>
					<td>${block.title}</td>
				</tr>

				<tr>
					<th>첨부파일</th>
					<td>
					<a href="/board_files/${block.file}">${block.file}</a>
					</td>
				</tr>

				<tr>
					<th>내용</th>
					<td>
					${block.body.replace(/\n/g, '<br>')}
					${img_html}
					</td>
				</tr>
			</tbody>
			
			</table>
			</div>

			<div class="btn_r">
				<a href="JavaScript:onPage(${pagenum})"><img src="btn_list.gif" alt="list"></a>
			</div>
	  `;
	article_box.innerHTML = html;
    
}


function onPage(num) {
	pagenum = num;
    let html = '';
	const perPage = 10;
	//const start = blocks.length - (pagenum - 1) * perPage;
	const start = (pagenum) * perPage;
	const pageBlocks = blocks.slice(Math.max(start - perPage, 0), start);
	pageBlocks.forEach((block, idx) => {
	//<td class="txtL"><a href="JavaScript:onView(${blocks.indexOf(block)})">${block.title}</a></td>
	let blocks_len = blocks.length;
	let block_idx = blocks.indexOf(block)
	//<td class="txtL"><a href="#" onclick="onView(${block_idx})">${block.title}</a></td>
	html += `
	    <tr>
	      <td class="txtC">${blocks_len-block_idx}</td>
		  <td class="txtL"><a href="JavaScript:onView(${block_idx})">${block.title}</a></td>
	      <td class="txtC">관리자</td>
	      <td class="txtC">${block.date}</td>
	    </tr>
	  `;
	});
    article_box.innerHTML = html;
}



</script>


</body></html>



